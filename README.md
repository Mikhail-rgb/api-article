# api-article

Данный проект является решением тестовго задания:




Создать REST апи по редактированию статей на laravel:

Сделать 4 метода:
1.	Список
2.	Создание
3.	Редактирование
4.	Удаление

У каждой статьи следующие параметра:

1.	Название
2.	Текст
3.	Теги

Теги должны быть уникальными в бд и хранится отдельно, при списке/создании/редактировании передаваться названия а не ид, названия сравниваются без учета регистра.

Для создания программы использовался следующий инструментарий:
- Laravel Framework 8.55.0;
- язык программирования PHP 7.4.3;
- СУБД MySQL.

**Все запросы и отеты в формате JSON.**
___
## Создание статьи 

/api/articles

Этот запрос создает новую статью в таблице базы данных.

Адрес для отправки запроса:
http://127.0.0.1:8000/api/articles

Метод запроса: POST.

Параметры запроса:
- Название статьи - title (string), обязательный параметр, может повторяться у нескольких статей.
- Текст статьи - content (text), обязательный параметр.
- Тэги статьи - tags (array), обязательный параметр, может повторяться у разных статей.


Параметры ответа:
- Уникальый идентификатор созданной статьи - id (int), необязательный параметр.
- Сообщение об ошибке - message (string), необзятельный параметр.
- Содержание ошибки - error (json), необязательный параметр, содержет в себе ключ (название поля запроса) и значение (массив с перечислением ошибок, связанными с полями запроса). 



Пример запроса:

```json
{
    "title":"ОСАГО-2021: для водителей ввели важные изменения",
    "content": "Подробности о новвоведениях в работе и возможностях полисов ОСАГО раскрыли Autonews.ru в Центробанке. Соответствующие нормативные акты ЦБ вступили в силу 29 августа. Одним из важных изменений стало снятие запрета на вступление в силу электронного договора ОСАГО в день его заключения. До этого момента страховые компании не имели права заключать договоры Е-ОСАГО, который начинал бы действовать ранее, чем через 72 часа после оформления. Ранее указания ЦБ предусматривали обязательное наличие такой отсрочки. Если если это требование нарушалось, страховщиков наказывали. Такой подход в ЦБ объясняли необходимостью защиты от мошенников и случаев, когда водители без ОСАГО могли устроить аварию и оформить документ сразу после ДТП. А вот добросовестные водители оставались без возможности быстро застраховаться. Теперь же у каждого страховщика есть возможность устанавливать актуальные на их взгляд сроки.",
    "tags": [
        "авто",
        "осаго",
        "автомобили",
        "пдд"
    ]
}
```

Пример успешного ответа:
```json
{
    "id": 1
}
```
Пример неуспешного ответа:

```json
{
    "message": "The given data was invalid.",
    "errors": {
        "title": [
            "The title field is required."
        ]
    }
}
```


___
## Получение списка статей

/api/articles/all/{perPage?}

Этот запрос выводит информацию о всех имеющихся в базе статьях.

С целью снижения нагрузки на сервис был предусмотрен метод вывода списка статей по частям (пагинация). В запросе можно указать количество статей на странице (по умолчанию количество статей на странице 5). Если количество статей меньше, чем указанное количество статей на странице, то пагинация не используется.

Адрес для отправки запроса о выводе каталога товаров:
http://127.0.0.1:8000/api/articles/all/2

Метод запроса: GET.

Параметры ответа:
- Текущая страница - current_page (int), необязательный параметр.
- Информация о статьях - data (array), необязательный параметр.
- Ссылка на первую страницу - first_page_url (url), необязательный параметр.
- Номер текущей страницы - from (int), необязательный параметр.
- Ссылка на следующую страницу - next_page_url (url), необязательный параметр.
- Адресс текущей страницы - path (url), необязательный параметр.
- Количество статей на странице - per_page (int), необязательный параметр.
- Ссылка на предыдущую страницу - prev_page_url (url), необязательный параметр.
- Номер следующей страницы - to (int), необязательный параметр.
- Сообщение об ошибке - message (string), необязательный параметр.

Массив "data" содержит в себе элементы типа JSON с информацией о статьях (если пагинация не используется, то выводится только содержимое массива):
- Уникальный идентификатор статьи - id (int).
- Название статьи - title (string).
- Содержание статьи - content (text).
- Уникальные идентификаторы тегов которые относятся к данной статье - tag_ids (array).


    
Пример успешного ответа:

```json
{
    "current_page": 1,
    "data": [
        {
            "id": 1,
            "title": "ОСАГО-2021: для водителей ввели важные изменения",
            "content": "Подробности о новвоведениях в работе и возможностях полисов ОСАГО раскрыли Autonews.ru в Центробанке. Соответствующие нормативные акты ЦБ вступили в силу 29 августа. Одним из важных изменений стало снятие запрета на вступление в силу электронного договора ОСАГО в день его заключения. До этого момента страховые компании не имели права заключать договоры Е-ОСАГО, который начинал бы действовать ранее, чем через 72 часа после оформления. Ранее указания ЦБ предусматривали обязательное наличие такой отсрочки. Если если это требование нарушалось, страховщиков наказывали. Такой подход в ЦБ объясняли необходимостью защиты от мошенников и случаев, когда водители без ОСАГО могли устроить аварию и оформить документ сразу после ДТП. А вот добросовестные водители оставались без возможности быстро застраховаться. Теперь же у каждого страховщика есть возможность устанавливать актуальные на их взгляд сроки.",
            "tag_ids": [
                1,
                2,
                3,
                4
            ]
        },
        {
            "id": 2,
            "title": "Штрафы за музыку и неправильный свет. В ГИБДД все объяснили",
            "content": "В каких случаях водителям грозят штрафы за дополнительное аудио- и светооборудование подробно объяснили в Госавтоинспекции. Поводом для обращения Autonews.ru в ведомство стал рейд воронежской ГИБДД в начале августа. Тогда к административной ответственности за внесение изменений в конструкцию автомобилей за два дня привлекли 148 водителей. В их числе оказались собственники, которые установили на свои автомобили усилители звука, дополнительные колонки и сабвуферы. Штрафы также выписали и за неправильный цвет дополнительных ламп внутри головного освещения.",
            "tag_ids": [
                1,
                5,
                3,
                4,
                6
            ]
        }
    ],
    "first_page_url": "http://127.0.0.1:8000/api/articles/all/2?page=1",
    "from": 1,
    "next_page_url": "http://127.0.0.1:8000/api/articles/all/2?page=2",
    "path": "http://127.0.0.1:8000/api/articles/all/2",
    "per_page": 2,
    "prev_page_url": null,
    "to": 2
}
```


Пример неуспешного ответа:
```json
{
    "message": "can`t find any article in DB"
}
```

___
## Получение списка тегов

/api/tags/all/{perPage?}

Этот запрос выводит информацию о всех имеющихся в базе тегах.

С целью снижения нагрузки на сервис был предусмотрен метод вывода списка тегов по частям (пагинация). В запросе можно указать количество статей на странице (по умолчанию количество тегов на странице 10). Если количество тегов меньше, чем указанное количество тегов на странице, то пагинация не используется.

Адрес для отправки запроса о выводе каталога товаров:
http://127.0.0.1:8000/api/tags/all/20

Метод запроса: GET.

Параметры ответа:
- Текущая страница - current_page (int), необязательный параметр.
- Информация о тегах - data (array), необязательный параметр.
- Ссылка на первую страницу - first_page_url (url), необязательный параметр.
- Номер текущей страницы - from (int), необязательный параметр.
- Ссылка на следующую страницу - next_page_url (url), необязательный параметр.
- Адресс текущей страницы - path (url), необязательный параметр.
- Количество тегов на странице - per_page (int), необязательный параметр.
- Ссылка на предыдущую страницу - prev_page_url (url), необязательный параметр.
- Номер следующей страницы - to (int), необязательный параметр.
- Сообщение об ошибке - message (string), необязательный параметр.

Массив "data" содержит в себе элементы типа JSON с информацией о тегах (если пагинация не используется, то выводится только содержимое массива):
- Уникальный идентификатор тега - id (int).
- Значение тега - tag (string).
- Уникальные идентификаторы статей к которым относится данный тег - article_ids (array).



Пример успешного ответа:
```json
[
    {
        "id": 1,
        "tag": "авто",
        "article_ids": [
            1,
            2
        ]
    },
    {
        "id": 2,
        "tag": "осаго",
        "article_ids": [
            1
        ]
    },
    {
        "id": 3,
        "tag": "автомобили",
        "article_ids": [
            1,
            2
        ]
    },
    {
        "id": 4,
        "tag": "пдд",
        "article_ids": [
            1,
            2
        ]
    },
    {
        "id": 5,
        "tag": "штрафы",
        "article_ids": [
            2
        ]
    },
    {
        "id": 6,
        "tag": "гибдд",
        "article_ids": [
            2
        ]
    },
    {
        "id": 7,
        "tag": "футбол",
        "article_ids": [
            3
        ]
    },
    {
        "id": 8,
        "tag": "спорт",
        "article_ids": [
            3
        ]
    },
    {
        "id": 9,
        "tag": "новости",
        "article_ids": [
            3
        ]
    },
    {
        "id": 10,
        "tag": "психология",
        "article_ids": [
            4
        ]
    },
    {
        "id": 11,
        "tag": "самолеты",
        "article_ids": [
            4
        ]
    },
    {
        "id": 12,
        "tag": "медицина",
        "article_ids": [
            4
        ]
    },
    {
        "id": 13,
        "tag": "советы",
        "article_ids": [
            4
        ]
    }
]
```

Пример неуспешного ответа:
```json
{
    "message": "can`t find any tags in DB"
}
```

Также предусмотрены запросы для вывода информации о теге по его id (/api/tags/id/{id}) и значению поля "tag" (/api/tags/tag/{tag}).

___
## Поиск статьи (по названию)

/api/articles/search/title/{title}/{perPage?}

Этот запрос выводит статьи с соответствующем названием в запросе.

С целью снижения нагрузки на сервис был предусмотрен метод вывода списка статей по частям (пагинация). В запросе можно указать количество статей на странице (по умолчанию количество статей на странице 5). Если количество статей меньше, чем указанное количество статей на странице, то пагинация не используется.

Адрес для отправки запроса:
http://127.0.0.1:8000/api/articles/search/title/Боюсь летать: как справиться с аэрофобией

Метод запроса: GET.

Параметры ответа:
- Текущая страница - current_page (int), необязательный параметр.
- Информация о статьях - data (array), необязательный параметр.
- Ссылка на первую страницу - first_page_url (url), необязательный параметр.
- Номер текущей страницы - from (int), необязательный параметр.
- Ссылка на следующую страницу - next_page_url (url), необязательный параметр.
- Адресс текущей страницы - path (url), необязательный параметр.
- Количество статей на странице - per_page (int), необязательный параметр.
- Ссылка на предыдущую страницу - prev_page_url (url), необязательный параметр.
- Номер следующей страницы - to (int), необязательный параметр.
- Сообщение об ошибке - message (string), необязательный параметр.

Массив "data" содержит в себе элементы типа JSON с информацией о статьях (если пагинация не используется, то выводится только содержимое массива):
- Уникальный идентификатор статьи - id (int).
- Название статьи - title (string).
- Содержание статьи - content (text).
- Уникальные идентификаторы тегов которые относятся к данной статье - tag_ids (array).


Пример успешного ответа:

```json
[
    {
        "id": 4,
        "title": "Боюсь летать: как справиться с аэрофобией",
        "content": "Аэрофобия может возникнуть безо всякой причины, а может стать результатом пережитого стресса, например, если вы стали свидетелем какой-то катастрофы. Страх сам по себе — естественная реакция организма, которая помогает нам вести себя так, как требуют обстоятельства. Мы привыкаем к базовому страху и практически не ощущаем его. Жить с ним помогает целый набор защитных механизмов.Но если в механизмах происходит сбой, появляются тревожные расстройства, навязчивые мысли, фобии, то есть страх, в котором полностью отсутствует здравый смысл.",
        "tag_ids": [
            10,
            11,
            12,
            13
        ]
    }
]
```


Пример неуспешного ответа:

```json
{
    "message": "cant`t find any article with a title `Звездные войны`"
}
```

___
## Поиск статьи (по тегам)

/api/articles/search/tags

Этот запрос выводит статьи с соответствующими тегами в теле запроса.

Адрес для отправки запроса:
http://127.0.0.1:8000/api/articles/search/tags

Метод запроса: GET.

Параметры запроса:
- Тэги для поиска статей - tags (array), обязательный параметр.

Параметры ответа:

Массив с элементами типа JSON, содержащие информацию о статьях.
- Уникальный идентификатор статьи - id (int), необязательный параметр.
- Название статьи - title (string), необязательный параметр.
- Содержание статьи - content (text), необязательный параметр.
- Уникальные идентификаторы тегов которые относятся к данной статье - tag_ids (array), необязательный параметр.
- Содержание ошибки - error (json), необязательный параметр, содержет в себе ключ (название поля запроса) и значение (массив с перечислением ошибок, связанными с полями запроса).



Пример запроса:

```json
{
    "tags": [
        "спорт",
        "психология"
    ]
}
```


Пример успешного ответа:

```json
[
    {
        "id": 3,
        "title": "Возвращение Роналду создаст кучу проблем «МЮ». И только сам Криштиану способен решить их",
        "content": "Криштиану Роналду в свои 36 лет все еще в космических кондициях и до сих пор в числе лучших голеадоров планеты. В минувшем сезоне CR7 стал лучшим бомбардиром серии А (29 голов) и Евро-2020 (5 забитых мячей). А с момента ухода из «Манчестер Юнайтед» в 2009 году статистика Криштиану ни разу не опускалась ниже 0,5 гола за матч. Очевидно, возвращение в «МЮ» — последний этап его карьеры. Теперь миссия португальца — вернуть «Юнайтед» на трон спустя девять лет после последнего чемпионства в АПЛ и побороться за шестой кубок Лиги чемпионов. Удастся или нет — во многом зависит от самого Криштиану. Разберем авантюру имени Роналду с тактической точки зрения.",
        "tag_ids": [
            7,
            8,
            9
        ]
    },
    {
        "id": 4,
        "title": "Боюсь летать: как справиться с аэрофобией",
        "content": "Аэрофобия может возникнуть безо всякой причины, а может стать результатом пережитого стресса, например, если вы стали свидетелем какой-то катастрофы. Страх сам по себе — естественная реакция организма, которая помогает нам вести себя так, как требуют обстоятельства. Мы привыкаем к базовому страху и практически не ощущаем его. Жить с ним помогает целый набор защитных механизмов.Но если в механизмах происходит сбой, появляются тревожные расстройства, навязчивые мысли, фобии, то есть страх, в котором полностью отсутствует здравый смысл.",
        "tag_ids": [
            10,
            11,
            12,
            13
        ]
    }
]
```


Пример неуспешного ответа:

```json
{
    "message": "The given data was invalid.",
    "errors": {
        "tags": [
            "The tags field is required."
        ]
    }
}
```

___
## Редактирование статьи 

/api/articles/update/title/{title}/{perPage?}

Этот запрос обновляет статьи в таблице базы данных. Статья определяется по названию.

Для обновления можно указать лишь те параметры, которые нужно обновить.

С целью снижения нагрузки на сервис был предусмотрен метод вывода списка статей по частям (пагинация). В запросе можно указать количество статей на странице (по умолчанию количество статей на странице 5). Если количество статей меньше, чем указанное количество статей на странице, то пагинация не используется.

Адрес для отправки запроса:
http://127.0.0.1:8000/api/articles/update/title/Штрафы за музыку и неправильный свет. В ГИБДД все объяснили


Метод запроса: PUT.

Параметры запроса:
- Название статьи - title (string), необязательный параметр.
- Текст статьи - content (text), необязательный параметр.
- Тэги статьи - tags (array), необязательный параметр.

Параметры ответа:
- Текущая страница - current_page (int), необязательный параметр.
- Информация о статьях - data (array), необязательный параметр.
- Ссылка на первую страницу - first_page_url (url), необязательный параметр.
- Номер текущей страницы - from (int), необязательный параметр.
- Ссылка на следующую страницу - next_page_url (url), необязательный параметр.
- Адресс текущей страницы - path (url), необязательный параметр.
- Количество статей на странице - per_page (int), необязательный параметр.
- Ссылка на предыдущую страницу - prev_page_url (url), необязательный параметр.
- Номер следующей страницы - to (int), необязательный параметр.
- Сообщение об ошибке - message (string), необязательный параметр.

Массив "data" содержит в себе элементы типа JSON с информацией о статьях (если пагинация не используется, то выводится только содержимое массива):
- Уникальный идентификатор статьи - id (int).
- Название статьи - title (string).
- Содержание статьи - content (text).
- Уникальные идентификаторы тегов которые относятся к данной статье - tag_ids (array).


Пример запроса:

```json
{
    "title": "Штрафы за музыку и неправильный свет"
}
```


Пример успешного ответа:

```json
[
    {
        "id": 2,
        "title": "Штрафы за музыку и неправильный свет",
        "content": "В каких случаях водителям грозят штрафы за дополнительное аудио- и светооборудование подробно объяснили в Госавтоинспекции. Поводом для обращения Autonews.ru в ведомство стал рейд воронежской ГИБДД в начале августа. Тогда к административной ответственности за внесение изменений в конструкцию автомобилей за два дня привлекли 148 водителей. В их числе оказались собственники, которые установили на свои автомобили усилители звука, дополнительные колонки и сабвуферы. Штрафы также выписали и за неправильный цвет дополнительных ламп внутри головного освещения.",
        "tag_ids": [
            1,
            5,
            3,
            4,
            6
        ]
    }
]
```


Пример неуспешного ответа:

```json
{
    "message": "cant`t find any article with a title `Надувные шары в Абхазии`"
}
```

___
## Удаление товара

/api/articles/delete/title/{title}

Этот запрос удаляет статьи из таблицы базы данных в соответствии с указаным в запросе названием. 

Адрес для отправки запроса:
http://127.0.0.1:8000/api/articles/delete/title/Возвращение Роналду создаст кучу проблем «МЮ». И только сам Криштиану способен решить их

Метод запроса: DELETE.

Параметры ответа:
- Сообщение о том, что статья успешно удалена - message (string), необязательный параметр.
- Сообщение об ошибке - message (string), необязательный параметр.


Пример успешного ответа:

```json
{
    "message": "article(s) with a title `Возвращение Роналду создаст кучу проблем «МЮ». И только сам Криштиану способен решить их` deleted"
}
```


Пример неуспешного ответа:

```json
{
    "message": "cant`t find any article with a title `Лучшие бары Перми`"
}
```
